{% load staticfiles %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="{% static 'dashboard/css/bootstrap.min.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css'>
<link rel="stylesheet" href="{% static 'multi_form/style.css' %}">
<link rel="stylesheet" href="{% static 'dashboard/css/side_navigations.css' %}">
<link rel="shortcut icon" type="image/x-icon" href="{% static 'dashboard/img/Brayn_Favicon_75.png' %}">

<!-- Loading style style CSS
============================================ -->
<link rel="stylesheet" href="{% static 'css/loading_spinner.css' %}">



<style>
body {font-family: Arial, Helvetica, sans-serif;}

/* The Modal (background) */
.rest_api_modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  z-index: 999;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}


  .logo_image_style {
    float: left;
    position: relative;
    z-index: 99;
  }

  .show {
    visibility: visible !important;
    opacity: 1 !important;
  }

  body {
    background-color: #0000 !important;
  }

  .select2-container {
    width: 100% !important;
  }

  .select2-container--default .select2-selection--single {
    height: 35px !important;
  }

  /*style for the switch toggle radio buttons*/
  .switch-field {
    display: flex;
    margin-bottom: 36px;
    overflow: hidden;
  }

  .switch-field input {
    position: absolute !important;
    clip: rect(0, 0, 0, 0);
    height: 1px;
    width: 1px;
    border: 0;
    overflow: hidden;
  }

  .switch-field label {
    background-color: #e4e4e4;
    color: rgba(0, 0, 0, 0.6);
    font-size: 14px;
    line-height: 1;
    text-align: center;
    padding: 8px 16px;
    margin-right: -1px;
    border: 1px solid rgba(0, 0, 0, 0.2);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px rgba(255, 255, 255, 0.1);
    transition: all 0.1s ease-in-out;
  }

  .switch-field label:hover {
    cursor: pointer;

  }

  .switch-field input:checked+label {
    background-color: #a5dc86;
    box-shadow: none;
  }

  .switch-field label:first-of-type {
    border-radius: 4px 0 0 4px;
  }

  .switch-field label:last-of-type {
    border-radius: 0 4px 4px 0;
  }

  /*end of style switch toggle button*/

  /*style for scroll */
  .scroller {
    overflow: auto;
    height: 230px !important;
    margin-top: 3%;
  }

  /* width */
  ::-webkit-scrollbar {
    width: 20px;
  }

  /* Track */
  ::-webkit-scrollbar-track {
    box-shadow: inset 0 0 5px grey;
    border-radius: 10px;
  }

  /* Handle */
  ::-webkit-scrollbar-thumb {
    background: #4a90e2;
    border-radius: 10px;
  }

  /*end of style for scroll*/



  .right_margin {
    margin-right: 2%;
  }

  .file_names {
    list-style-type: none;
    color: #4a90e2;
    margin-left: 3%;
    height: 80px;
    overflow-y: auto;
  }

  .file_names li:before {
    content: "\2714\0020";
  }

  label {
    text-transform: uppercase;
  }



.border_black {
  border: 2px solid darkgreen;
}
#api_button {
  margin: 2% auto 0 auto;
  background: #4a90e2;
  padding: 1%;
  color: #fff;
  border-radius: 7px;
  width: 30%;
}

.modal-close {
  width: 100px !important;
  background: #4a90e2;
  text-transform: uppercase;
  border-radius: 5px;
  font-weight: bold;
  color: white;
  border: 0 none;
  cursor: pointer;
  padding: 10px 5px;
  margin: 10px auto;
  -webkit-transition: all 0.3s linear 0s;
  -moz-transition: all 0.3s linear 0s;
  -ms-transition: all 0.3s linear 0s;
  -o-transition: all 0.3s linear 0s;
  transition: all 0.3s linear 0s;
  display: block;
}

th.spaced:before {
  content: "\00a0 \00a0 \00a0 \00a0 \00a0 \00a0 \00a0 ";
}

.disabled {
  pointer-events:none;
}

.info-close-btn {
  float: right;
cursor: pointer;
font-size: 29px;
}
}
</style>

<!-- <div id="loader" class="center" style="display:none;"></div> -->
<div class="loading-overlay">
  <span class="fas fa-spinner fa-3x fa-spin"></span>
  <span class="loading-message">Please wait..it's loading</span>
</div>


<!-- START: Menu section for the page -->
<div class="ruby-wrapper">
  <a href="/dashboard/" class="logo_image_style"><img src="https://therealmstorage.sgp1.cdn.digitaloceanspaces.com/brayn/images/logos/logo.png" alt="" style="max-width: 85%;"></a>
  <button class="c-hamburger c-hamburger--htx visible-xs">
    <span>toggle menu</span>
  </button>
  <ul class="ruby-menu" style="padding-left: 15%;">
    <!-- <li class="ruby-menu-mega-blog" onclick="blogDropdown(event)">
        Dashboards


      </li> -->
      <li id="hover_poject_style" class="project_titles" style="margin-left: 29%;"><h3 style="margin-top: 4%;">CREATE A NEW PROJECT</h3></li>
    {% if customer.image  %}
    <li class="ruby-menu-right" onclick="callLogout()">

      <!-- <img src="{{customer.image.url}} " alt="user_images" onclick="callLogout()"> -->
      <a class="up_arrow" href="#">WELCOME {{request.user.first_name}}</a>
      {% else %}
    <li class="ruby-menu-right" <img src="https://img.icons8.com/cotton/64/000000/gender-neutral-user--v1.png"
      onclick="callLogout()"><a class="up_arrow" href="#">WELCOME {{request.user.first_name}}</a>
      {% endif %}
      <ul id="logout" onclick="event.stopPropagation()">
        <li><a href="{%url 'coreapp:dashboard' %}">My Projects</a></li>
        <li><a href="{%url 'coreapp:logout' %}">Logout</a></li>
      </ul>

      <span class="ruby-dropdown-toggle"></span></li>
  </ul>
</div>
<!-- END: Menu section for the page -->







<div class="container">
  <div id="modal-1" class="modal" data-modal-effect="slide-top" style="top: 40%;">
    <div class="modal-content">
      <h2 class="fs-title">Project Info</h2>
      <h3 class="fs-subtitle">Getting the most out of your data</h3>
      <p style="text-align: center;">AN EYE FOR AN I</p>
      <input type="button" name="next" class="modal-close" value="Got it!">
    </div>
  </div>
</div>

<div class="container">
  <div id="modal-2" class="modal" data-modal-effect="slide-top" style="top: 40%;">
    <div class="modal-content">
      <h2 class="fs-title">Upload Data</h2>
      <h3 class="fs-subtitle">Getting the most out of your data</h3>
      <!--<p style="text-align: center;">AN EYE FOR AN I</p>-->
      <input type="button" name="next" class="modal-close" value="Got it!">
    </div>
  </div>
</div>

<!-- Modal -info -->
<div class="container">
  <div id="modal-3" class="modal" data-modal-effect="slide-top">
    <div class="modal-content">
      <h2 class="fs-title">Make us Understand your data</h2>
      <h3 class="fs-subtitle">Getting the most out of your data</h3>
      <p>Identify a time series column for analysis if relevant. Identify columns with matching keys between your data files to help us understand the relationships in the data.</p>
      <input type="button" name="next" class="modal-close" value="Got it!">
    </div>
  </div>
</div>

<div class="container">
  <div id="modal-4" class="modal" data-modal-effect="slide-top">
    <div class="modal-content">
      <h2 class="fs-title">Score Indexkjbdskjdb</h2>
      <h3 class="fs-subtitle">Getting the most out of your data</h3>
      <p>AN EYE FOR AN I.</p>
      <input type="button" name="next" class="modal-close" value="Got it!">
    </div>
  </div>
</div>



<form class="steps" accept-charset="UTF-8" enctype="multipart/form-data" novalidate="" id="project_form">
  {%csrf_token%}
  {{project_form.media}}
  <ul id="progressbar">
    <li class="active">Project Info</li>
    <li>File upload</li>
    <li>Delimeter selection</li>
    <li>NAN SELECTION</li>
    <li>File Relationship</li>
  </ul>



  <!-- USER INFORMATION FIELD SET -->
  <fieldset id="first_fieldset" style="height:auto">

    <div class="display_next">
      <h2 class="fs-title">Project Info</h2>
      <!-- <img src="{% static 'images/info.png' %}"  id="icon1" class="explanation info_icon"
        title="Click the color palette to choose the color of the dashboard" data-modal-id="modal-2"> -->
    </div>
    <!-- <h3 class="fs-subtitle">We just need some basic information to begin your scoring</h3> -->
    <div class="alert alert-danger" id="mandatory_fields_error_message"  role="alert" style="display:none;font-size:10px;">
      PLEASE FILL ALL THE FIELDS AND PROCEED!
    </div>
    <div class="alert alert-danger" id="Invalid_project_name"  role="alert" style="display:none;font-size:10px;">

    </div>
    <div class="row">

      <div class="col-md-4">
        <!-- Begin What's Your First Name Field -->
        <div class="hs_firstname field hs-form-field">

          <!-- <label for="firstname-99a6d115-5e68-4355-a7d0-529207feb0b3_2983">PROJECT TITLE *</label> -->
          <label for="firstname-99a6d115-5e68-4355-a7d0-529207feb0b3_2983">PROJECT TITLE</label>

          <!-- <input id="firstname-99a6d115-5e68-4355-a7d0-529207feb0b3_2983" name="firstname" required="required" type="text" value="" placeholder="" data-rule-required="true" data-msg-required="Please include your first name" > -->
          {{project_form.project_title}}
          <span class="error1" style="display: none;">
            <i class="error-log fa fa-exclamation-triangle"></i>
          </span>
        </div>
        <!-- End What's Your First Name Field -->
      </div>
      <div class="col-md-5">
        <!-- Begin What's Your Email Field -->
        <div class="hs_email field hs-form-field">

          <label for="email-99a6d115-5e68-4355-a7d0-529207feb0b3_2983">INDUSTRY </label><br />
          {{project_form.industry}}
          <!-- <input id="email-99a6d115-5e68-4355-a7d0-529207feb0b3_2983" name="email" required="required" type="email" value="" placeholder="" data-rule-required="true" data-msg-required="Please enter a valid email address." > -->
          <span class="error1" style="display: none;">
            <i class="error-log fa fa-exclamation-triangle"></i>
          </span>
        </div>
        <!-- End What's Your Email Field -->
      </div>
      <div class="col-md-3">
        <!-- Begin Color picker Field Field -->
        <div class="hs_firstname field hs-form-field">

          <div class="" style="display:flex;">
            <label for="firstname-99a6d115-5e68-4355-a7d0-529207feb0b3_2983" style="font-size:14px;">CHOOSE YOUR PROJECT COLOR</label>
            <img src="{% static 'images/info.png' %}" id="icon2" class="info_icon"
              title="This is the project panel colour that will be displayed on the account homepage along with all your other projects." style="margin-left: 3%;margin-top: 4%;" >
          </div>
          <!-- <input id="color_id" name="color" class="jscolor {onFineChange:'update()'}" style="height:35px;margin:0;" readonly> -->
          <input name="color" id="color_id" style="height:35px;margin:0;color:rgb(255, 255, 255,0);" value="rgb(74, 144, 226)" readonly>
          <div class="main_color_background">
            <div class="color_height" style="background:#88e1f2;" id="color1" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#ED4166;" id="color2" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#56ff00;" id="color3" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#af460f;" id="color4" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#0f4c75;" id="color5" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#617be3" id="color6" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#561f55" id="color7" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#0092ff" id="color8" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#aaaaaa" id="color9" onclick="selectedColor(this)">

            </div>
            <div class="color_height margin_class" style="background:#ff0000" id="color10" onclick="selectedColor(this)">

            </div>

            <div class="color_height margin_class border_black" style="background:#4a90e2" id="color11" onclick="selectedColor(this)">

            </div>

          </div>

          <!-- <p  id="rect" style="border: 1px solid gray;width: 54px;height: 27px;margin-left: 60%;margin-top: -7%;"></p> -->
          <!-- <input id="firstname-99a6d115-5e68-4355-a7d0-529207feb0b3_2983" name="firstname" required="required" type="text" value="" placeholder="" data-rule-required="true" data-msg-required="Please include your first name" > -->

          <!-- <span class="error1" style="display: none;">
            <i class="error-log fa fa-exclamation-triangle"></i>
          </span> -->
        </div>
        <!-- End Color picker Field -->
      </div>
    </div>

    <div class="row">
      <div class="col-md-4">
        <!-- Begin What's Your First Name Field -->
        <div class="hs_firstname field hs-form-field">
          <div class="" style="display:flex;">
            <label for="firstname-99a6d115-5e68-4355-a7d0-529207feb0b3_2983" style="font-size:14px;">PROJECT END GOAL</label>
            <img src="{% static 'images/info.png' %}" id="icon2" class="info_icon"
              title="What is the intended analyis about?" style="margin-left: 3%;margin-top: 3%;">
          </div>
          <!-- <input id="firstname-99a6d115-5e68-4355-a7d0-529207feb0b3_2983" name="firstname" required="required" type="text" value="" placeholder="" data-rule-required="true" data-msg-required="Please include your first name" > -->
          {{project_form.end_goal}}
          <!-- <span class="error1" style="display: none;">
            <i class="error-log fa fa-exclamation-triangle"></i>
          </span> -->
        </div>
        <!-- End What's Your First Name Field -->
      </div>
      <div class="col-md-5">
        <!-- Begin What's Your Email Field -->
        <div class="hs_email field hs-form-field">

          <label for="email-99a6d115-5e68-4355-a7d0-529207feb0b3_2983">PROJECT DURATION</label><br />
          {{project_form.project_duration}}
          <!-- <input id="email-99a6d115-5e68-4355-a7d0-529207feb0b3_2983" name="email" required="required" type="email" value="" placeholder="" data-rule-required="true" data-msg-required="Please enter a valid email address." > -->
          <!-- <span class="error1" style="display: none;">
            <i class="error-log fa fa-exclamation-triangle"></i>
          </span> -->
        </div>
        <!-- End What's Your Email Field -->
      </div>

    </div>




    <!-- Begin Total Number of Constituents in Your Database Field -->
    <div class="hs_email field hs-form-field hs_total_number_of_constituents_in_your_database" style="margin-top:3%">
      <div class="" style="display:flex;">
        <label for="firstname-99a6d115-5e68-4355-a7d0-529207feb0b3_2983" style="font-size:14px;">DESCRIPTION</label>
        <img src="{% static 'images/info.png' %}" id="icon2" class="info_icon"
          title="Please provide a brief description of the project" style="margin-left: 1%;margin-top: 1%;">
      </div>
      <textarea id="description" name="data_description" rows="8" cols="40"></textarea>
      <!-- <input id="edit-submitted-constituent-base-total-constituents" class="form-text hs-input" name="total_number_of_constituents_in_your_database" required="required" size="60" maxlength="128" type="number" value="" placeholder="" data-rule-required="true" data-msg-required="Please enter a valid number" > -->
      <!-- <span class="error1" style="display: none;">
        <i class="error-log fa fa-exclamation-triangle"></i>
      </span> -->
    </div>
    <!-- End Total Number of Constituents in Your Database Field -->
    <p class="required_note">* All fields are mandatory.</p>

    <!-- <img src="{% static 'images/info.png' %}" class="info_icon"
      title="Click the color palette to choose the color of the dashboard"> -->
    <input type="button" id="first_button" data-page="1"  name="next" class="next action-button" value="Next">
    <!-- <div class="" style="display:flex;">
      <img src="{% static 'images/info.png' %}" class=""/>
      <input type="button" data-page="1" name="next" class="next action-button" value="Next"
      onclick="projectCreate()"  >
    </div> -->
    <!-- <div class="explanation btn btn-small modal-trigger" data-modal-id="modal-3">
    <i class="question-log fa fa-question-circle"></i> What Is This?</div> -->
  </fieldset>



  <!-- ACQUISITION FIELD SET -->
  <fieldset>
    <div class="display_next">
      <h2 class="fs-title">upload your data</h2>
      <img src="{% static 'images/info.png' %}" id="icon2" class="info_icon modal-trigger explanation"
        title="Upload files" data-modal-id="modal-2">
    </div>
    <div class="alert alert-danger" id="file_size_error_message"  role="alert" style="display:none;font-size:10px;">
      File size exceeds 120 MB
    </div>

    <!-- <h3 class="fs-subtitle">How have you been doing in acquiring donors?</h3> -->
    <!-- Begin Total Number of Donors in Year 1 Field -->
    <div
      class="form-item webform-component webform-component-textfield hs_total_number_of_donors_in_year_1 field hs-form-field"
      id="webform-component-acquisition--amount-1">

      <!-- <label for="edit-submitted-acquisition-amount-1 total_number_of_donors_in_year_1-99a6d115-5e68-4355-a7d0-529207feb0b3_6344">What was your number of total donors in year 1? *</label> -->


    </div>

    <div class="row" style="margin-top: 3%;">
      <div class="col-md-6">

        <div class="" style="display:flex;">
          <div class="">
            <!-- <label for="">wefwpeofn</label> -->
            <input type="radio" name="upload_files" value="" style="width: 26px;margin-top: 64%;" checked onclick="disableFunction()">
          </div>
          <div class="disable_functionality" style="width: 100%;">
            <label for="id_files">Upload File/s</label>

            <div class="file_upload_section">
              {{project_form.files}}
              <p style="color: #8D9498;font-size: 17px;">Drag & Drop here or click to Upload.<br />
                <span>(CSV-UTF-8/XLSX)</span>
              </p>

            </div>


            <p id="no_of_files" style="display:none;">No Of File Selected</p>
            <ul class="file_names">

            </ul>

            <!-- <span class="error1" style="display: none;">
              <i class="error-log fa fa-exclamation-triangle"></i>
            </span> -->
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="" style="display:flex;">
          <div class="" >
            <!-- <label for="">wefwpeofn</label> -->
            <input type="radio" name="upload_files" value="" style="width: 26px;margin-top: 64%;" onclick="removeDisable()">
          </div>
          <div class="" id="data-integration">
            <label for="">Data Integration</label>
            <div class="row api_integration disabled" >
                            <div class="col-md-4">
                                <!-- <a href="#">

                                  <img src="https://img.icons8.com/color/48/000000/google-drive.png"
                                    style="display: inline-block;width: 19%;"><span style="font-weight: bold;">GOOGLE
                                    DRIVE</span></a><br><br> -->
                                <a href="#"><img
                                    src="https://img.icons8.com/color/48/000000/google-sheets.png"
                                    style="display: inline-block;width: 13%;"><span onclick="GoogleModal()" style="font-weight: bold;">GOOGLE
                                    SHEETS</span></a><br><br>
                                <a href="#"><img
                                    src="https://img.icons8.com/color/48/000000/dropbox.png"
                                    style="display: inline-block;width: 13%;"><span
                                    style="font-weight: bold;">DROPBOX</span></a><br><br>
                                <!-- <a href=""><img
                                    src="https://img.icons8.com/color/48/000000/file.png" style="display: inline-block;width: 13%;"><span
                                    style="font-weight: bold;">ADD ON FILES</span></a><br><br> -->

                            </div>
                            <div class="col-md-4">
                              <a href="#"><img
                                  src="https://therealmstorage.sgp1.cdn.digitaloceanspaces.com/brayn/images/logos/segment_icon.png" style="display: inline-block;width: 13%;"><span
                                  style="font-weight: bold;margin-left: 1%;">SEGMENT</span></a><br><br>

                              <a href="#"><img

                                  src="https://therealmstorage.sgp1.cdn.digitaloceanspaces.com/brayn/images/logos/rest_api.png" style="display: inline-block;width: 15%;"><span
                                  style="font-weight: bold;margin-left: 1%;" id="myBtn" >REST API</span><br><br></a>
                            </div>
                          </div>
            <!-- {{project_form.files}}
              <span class="error1" style="display: none;">
                  <i class="error-log fa fa-exclamation-triangle"></i>
              </span> -->
          </div>
        </div>
      </div>
    </div>

    <!-- End Total Number of Donors in Year 1 Field -->

    <!-- Begin Total Number of Donors in Year 2 Field -->
    <!-- <div class="form-item webform-component webform-component-textfield hs_total_number_of_donors_in_year_2 field hs-form-field" id="webform-component-acquisition--amount-2">

        <label for="edit-submitted-acquisition-amount-2 total_number_of_donors_in_year_2-99a6d115-5e68-4355-a7d0-529207feb0b3_6344">What was your number of total donors in year 2? *</label>

       {{project_form.file_2}}
        <span class="error1" style="display: none;">
            <i class="error-log fa fa-exclamation-triangle"></i>
        </span>
      </div> -->
    <!-- End Total Number of Donors in Year 2 Field -->

    <!-- Begin Calc of Total Number of Donors Fields -->
    <!-- THIS FIELD IS NOT EDITABLE | GRAYED OUT -->
    <!-- <div class="form-item webform-component webform-component-textfield webform-container-inline hs_total_donor_percent_change field hs-form-field">

        <label for="edit-submitted-acquisition-percent-change total_donor_percent_change-99a6d115-5e68-4355-a7d0-529207feb0b3_6344">Total Donors Percent Change</label>

        {{project_form.file_3}}
      </div> -->
    <!-- End Calc of Total Number of Donors Fields -->

    <!-- <input type="button" data-page="2" name="previous" class="previous action-button"  value="Previous" /> -->
    <input type="button" data-page="2" id="second_button" name="next" style="position: absolute;bottom: 2%;right: 3%;" class="next action-button" value="Next" />
    <!-- <div class="explanation btn btn-small modal-trigger" data-modal-id="modal-3">What Is This?</div> -->
  </fieldset>



  <!-- Cultivation FIELD SET -->
  <fieldset>
    <div class="display_next" style="justify-content:space-between">
      <h2 class="fs-title">view your data</h2>
      <!-- <img src="{% static 'images/info.png' %}" class="info_icon modal-trigger explanation"
        title="Click the color palette to choose the color of the dashboard" data-modal-id="modal-2"> -->
      <h3 class="fs-subtitle" id="total_project_files"> Total Number of Files:</h3>
    </div>


    <!-- div  to append the headers yes or no -->
    <div class="" id="delimeter_content_id"></div>
    <div class="" id="test_content_id"></div>
    <!-- <input type="button" data-page="3" name="previous" class="previous action-button" value="Previous" /> -->
    <input type="button" data-page="3" id="third_button" name="next" class="next action-button"  style="position: absolute;bottom: 2%;right: 3%;" value="Next"  />
    <!-- <img src="{% static 'images/info.png' %}" class="info_icon modal-trigger explanation"
      title="Click the color palette to choose the color of the dashboard" data-modal-id="modal-2"> -->
    <!-- <div class="explanation btn btn-small modal-trigger" >What Is This?</div> -->
  </fieldset>



  <!-- Cultivation2 FIELD SET -->
  <fieldset>
    <h2 class="fs-title">Choose Nan/s</h2>
    <!-- <h3 class="fs-subtitle">How long can you keep your donors and their donations?</h3> -->
    <div class="">
      <div class="row scroller " id="metadata_id" style="display:flex;">
        <div class="col-md-12 "></div>
      </div>
    </div>



    <!-- <input type="button" data-page="4" name="previous" class="previous action-button" value="Previous" /> -->
    <input type="button" id="fourth_button" data-page="4" name="next" class="next action-button" style="position: absolute;bottom: 2%;right: 3%;"  value="Next" />
    <!-- <div class="explanation btn btn-small modal-trigger" data-modal-id="modal-3">What Is This?</div> -->
  </fieldset>



  <!-- RETENTION FIELD SET -->
  <fieldset>






    <div class="display_next">
      <h2 class="fs-title">Make us understand your data</h2>
      <img src="{% static 'images/info.png' %}" class="explanation info_icon"
        title="Click the color palette to choose the color of the dashboard" id="icon3" data-modal-id="modal-3">
    </div>
    <!-- <h3 class="fs-subtitle">Let's talk about your donations as a whole</h3> -->
    <div>
      <div class="row">
        <div class="col-md-6" style="margin-top: 2%;">
          <label style="width: 55%;">
            Choose Time Series Column:
          </label>
          <div class="" style="width: 88%;">
            <p id="time_series_select_error" style="display: none;color:red;"></p>
            <select name="time_series_column" id="time_series_select" data-autocomplete-light-language="en"
              data-autocomplete-light-function="select2" tabindex="-1" class="select2-hidden-accessible"
              aria-hidden="true">
              <option value="no-time-series">-------------</option>
            </select>
          </div>
        </div>
      </div>
      <div style="margin-bottom: 3%;">
        <p id="relation_error_msg_id" style="display:none;"></p>

        <!-- <table class="table table-striped">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">First</th>
                  <th scope="col">Last</th>
                  <th scope="col">Handle</th>
                  <th scope="col">Handle</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">1</th>
                  <td>Mark</td>
                  <td>Otto</td>
                  <td>@mdo</td>
                  <td>@mdo</td>
                </tr>
                <tr>
                  <th scope="row">2</th>
                  <td>Jacob</td>
                  <td>Thornton</td>
                  <td>@mdo</td>
                  <td>@fat</td>
                </tr>
                <tr>
                  <th scope="row">3</th>
                  <td>Larry</td>
                  <td>the Bird</td>
                  <td>@twitter</td>
                  <td>@twitter</td>
                </tr>
              </tbody>
            </table> -->
        <div class="row" id="relation_create_row_id">
          <label style="margin-left:1.3%;">Choose your Relation between files</label>
          <div class="col-md-12" style="display:flex;">
            <div class="" style="width: 43%;">
              <select name="primarykey_relation" id="primarykey_relation_id" data-autocomplete-light-language="en"
                data-autocomplete-light-function="select2" tabindex="-1" class="select2-hidden-accessible"
                aria-hidden="true">
                <option value="">-------------</option>
              </select>
            </div>
            <div class="" style="width: 43%;margin-left: 2%;">
              <select name="foreignkey_relation" id="foreignkey_relation_id" data-autocomplete-light-language="en"
                data-autocomplete-light-function="select2" tabindex="-1" class="select2-hidden-accessible"
                aria-hidden="true">
                <option value="">-------------</option>
              </select>
            </div>
            <button type="button" class="action-button data_append_button" valu="Create"
              onclick="RelatioshipCreate()">Create</button>
          </div>
          <!-- <div class="col-md-1">==></div> -->
          <!-- <div class="col-md-5">
                <select name="foreignkey_relation" id="foreignkey_relation_id" data-autocomplete-light-language="en" data-autocomplete-light-function="select2"  tabindex="-1" class="select2-hidden-accessible" aria-hidden="true">
                    <option value="">-------------</option>
                </select>
              </div> -->
        </div>
        <div class="row" id="table_display_section" style="display:none">
          <div class="col-md-12 table_content">
            <table class="table table-striped" id="relationship_table">
              <thead>
                <tr>
                  <th scope="row">Primarykey File</th>
                  <th>Primarykey Column</th>
                  <th>ForeignKey File</th>
                  <th>ForeignKey Column</th>
                </tr>
              </thead>
              <tbody id="relation_div_id">


              </tbody>
            </table>
          </div>
        </div>

      </div>
    </div>





    <!-- <input type="button" data-page="5" name="previous" class="previous action-button" value="Previous" /> -->
    <input id="submit" style="bottom: 2%;"  class="hs-button primary large action-button next fixed_button" onclick="metaDataUpload()" type="button"
      value="Submit">
    <!-- <div class="explanation btn btn-small modal-trigger" data-modal-id="modal-3">What Is This?</div> -->
  </fieldset>

  <fieldset>
    <h2 class="fs-title">Thank you for creating the project!</h2>
    <h3 class="fs-subtitle">Please wait for few seconds as you will be redirected to Project dashboard!</h3>
    <!-- <div class="explanation btn btn-small modal-trigger" data-modal-id="modal-3">What Is This?</div> -->
  </fieldset>
  <input type="text" name="project" id="id_project" value="" style="visibility: hidden;" />

  <div id="myModal" class="rest_api_modal" style="visibility:visible !important">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="info-close-btn" onclick="document.getElementById('myModal').style.display='none'">×</span>
    <div class="row" style="padding: 0 3%;">
      <h3>ENTER YOUR API INFO</h3>
    <div clas="col-md-3">

      <label> API NAME</label>
    </div>
      <div class=""col-md-3>
      {{api_form.api_name}}
      </div>


    <div clas="col-md-3">

      <label> API</label>
    </div>
      <div class=""col-md-3>
      {{api_form.api}}
      </div>
    </div>
    <div class="row" style="padding: 0 3%;">
    <div clas="col-md-3">

      <label> TOKEN</label>
    </div>
      <div class=""col-md-3>
      {{api_form.basic_token}}
      </div>
    </div>
    <div class="row" style="padding: 0 3%;">
    <div clas="col-md-3">

      <label> DATA PULL FREQUENCY</label>
    </div>
      <div class=""col-md-3>
      {{api_form.frequency}}
      </div>
    </div>
    <input type="button" id="api_button" name="" onclick="apiDataCheck()" value="CONNECT">

    <span class="close">&times;</span>

  </div>

</div>
  <!-- partial -->



  <div id="myGoogleModal" class="rest_api_modal" style="visibility:visible !important">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="info-close-btn" onclick="document.getElementById('myGoogleModal').style.display='none'">×</span>
      <div class="row" style="padding: 0 3%;">
      <h3>ENTER YOUR GOOGLE SHEET INFO</h3>

      <!-- START:New tabs GSHEETS INTEGRATION -->
     <div class="col-md-12 border_class_endpoint_page" style="margin-bottom: 3%;">
       <!-- <h3 >MACHINE LEARNING</h3> -->
       <div class="layout" style="grid-template-columns: 1fr 1fr;margin-top: 2%;">


         <input name="nav" type="radio" class="nav home-radio modal_radio" id="home"  checked="checked" />
         <div class="page home-page">
           <div class="page-contents" style="position:absolute;left: 0;">
              <!-- {{sheet_url_form.as_p}} -->
              <div>
                <label> INTEGRATION NAME</label>
                {{sheet_url_form.sheet_url_name}}
              </div>
              <div>
                <label> URL</label>
                  {{sheet_url_form.url}}
               </div>
               <div>
                 <label>DATA STARTS FROM ROW</label>
                 {{sheet_url_form.header}}
                </div>
                <div>
                 <label> DATA PULL FREQUENCY</label>
                 {{sheet_url_form.cron_frequency}}
                </div>
              <input type="button" id="api_button" name="" onclick="googleDataCheck()" value="CONNECT">
           </div>
         </div>
         <label class="nav" for="home">
           <span>
              USING LINK
           </span>
         </label>

         <input name="nav" type="radio" class="about-radio modal_radio" id="about"/>
         <div class="page about-page">
           <div class="page-contents">
              <div>
                <label> INTEGRATION NAME</label>
                {{sheet_form.sheet_name}}
              </div>
              <div>
                <label> CREDENTIALS FILE</label>
                  {{sheet_form.credential}}
               </div>
               <div>
                 <label> SHEET NAME</label>
                 {{sheet_form.spreadsheet_id}}
                </div>
                <div>
                 <label> DATA STARTS FROM ROW</label>
                 {{sheet_form.sheet_header}}
                </div>

                <div>
                  <label> DATA PULL FREQUENCY</label>
                {{sheet_form.data_range}}
                  </div>
                  <input type="button" id="api_button" name="" onclick="googleDataCheck()" value="CONNECT">
           </div>
         </div>
         <label class="nav" for="about">
           <span>
             USING CREDENTIALS FILE
             </span>
           </label>


       </div>
     </div>

     <!-- END:New tabs GSHEETS INTEGRATION -->


    <span class="close">&times;</span>

  </div>

</div>
</form>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js'></script>
<script src="{% static 'multi_form/script.js' %}"></script>


<script>
  //script for the  project from first step of multistep form  //
  var current_fs, next_fs, previous_fs;
  var left, opacity, scale;
  var animating;


  $(".next").click(function () {
    // alert("hi")
      // $(".steps").validate({
      //     errorClass: 'invalid',
      //     errorElement: 'span',
      //     errorPlacement: function (error, element) {
      //         error.insertAfter(element.next('span').children());
      //     },
      //     highlight: function (element) {
      //         $(element).next('span').show();
      //     },
      //     unhighlight: function (element) {
      //         $(element).next('span').hide();
      //     }
      // });
      // if ((!$('.steps').valid())) {
      //     return true;
      // }
      // if (animating) return false;
      // animating = true;
      current_fs = $(this).parent();
      console.log("fwefi"+current_fs)
      next_fs = $(this).parent().next();
      console.log("fwewfewe"+next_fs)
      $('.select2-container').show();
      $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");
      console.log(next_fs)

      // For first button
      if(next_fs.context.id==="first_button"){
        // document.getElementById('loader').style.display = "block";
        document.querySelector('.loading-overlay').style.display = "block";

        var description = $('#description').val()
        var title = $('#id_project_title').val()
        var color = $('#color_id').val()
        var industry = $('#id_industry').val()
        var end_goal = $('#id_end_goal').val()
        var project_duration = $('#id_project_duration').val()
        var data = {
          'title': title,
          'description': description,
          'color': color,
          'industry': industry,
          'end_goal': end_goal,
          'project_duration': project_duration
        }
        if(description===''){
          document.querySelector('.loading-overlay').style.display = "none";
          document.getElementById('mandatory_fields_error_message').style.display="block";
          setTimeout(function(){  document.getElementById('mandatory_fields_error_message').style.display="none"; }, 3000);
          return false
        }
        if(end_goal===''){
          document.querySelector('.loading-overlay').style.display = "none";
          document.getElementById('mandatory_fields_error_message').style.display="block";
          setTimeout(function(){  document.getElementById('mandatory_fields_error_message').style.display="none"; }, 3000);
          return false
        }
        if(project_duration===''){
          document.querySelector('.loading-overlay').style.display = "none";
          document.getElementById('mandatory_fields_error_message').style.display="block";
          setTimeout(function(){  document.getElementById('mandatory_fields_error_message').style.display="none"; }, 3000);
          return false
        }
        var token = '{{csrf_token}}'
        $.ajax({
          method: "POST",
          headers: { "X-CSRFToken": token },
          url: '/project/create/ajax/',
          data: data,
          crossdomain: true,
          dataType:"json",
          success: function (data) {
            // alert(data.id);
            if (data.error_msg) {
              // document.getElementById('loader').style.display = "none";
              document.querySelector('.loading-overlay').style.display = "none";
              $('#Invalid_project_name').empty();
          $('#Invalid_project_name').html(data.error_msg);
          document.getElementById('Invalid_project_name').style.display="block";
          setTimeout(function(){  document.getElementById('Invalid_project_name').style.display="none"; }, 3000);
              // alert(data.error_msg);
            }
            else if (data.id) {
              // document.getElementById('loader').style.display = "none";
              document.querySelector('.loading-overlay').style.display = "none"
              $('#id_project').val(data.id);
              movetoNext()
            }


          }
        });
      }

      else if(next_fs.context.id==="second_button"){
        readFiles();
      }

      else if(next_fs.context.id==="third_button"){
          fileUpload();
      }

      else if(next_fs.context.id==="fourth_button") {
          metaDataGet()
      }

      //
  });

// START :  FUNCTION TO MOVE TO NEXT SECTION UPON SUCESS FROM AJAX
  function movetoNext() {
    // alert("from move to next");
    document.querySelector('.loading-overlay').style.display = "none"
    next_fs.show();
    current_fs.animate({
        opacity: 0
    }, {
        step: function (now, mx) {
            scale = 1 - (1 - now) * 0.2;
            left = (now * 50) + "%";
            opacity = 1 - now;
            current_fs.css({
                'transform': 'scale(' + scale + ')'
            });
            next_fs.css({
                'left': left,
                'opacity': opacity
            });
        },
        duration: 800,
        complete: function () {
            current_fs.hide();
            animating = false;
        },
        easing: 'easeInOutExpo'
    });
  }
// END :  FUNCTION TO MOVE TO NEXT SECTION UPON SUCESS FROM AJAX

  //end of script to create project from first step of multistep form //




  // function for header row loading

function headerRowDisplay(file_name){
  var value  = document.getElementById(file_name+'_header_row_input').value;
  var display_id_1 = '#'+file_name+'_header_disply_1';
  var display_id_2 = '#'+file_name+'_header_disply_2';
  var display_id_3 = '#'+file_name+'_header_disply_3';
  var display_id_4 = '#'+file_name+'_header_disply_4';
  var display_id_5 = '#'+file_name+'_header_disply_5';
// alert("the id"+id);
  // var value = $(id).val()
  // alert("the vales is "+value );
  if(value == '1'){
    // alert(value)
    document.getElementById(file_name+'_header_disply_1').style.display='block';
    document.getElementById(file_name+'_header_disply_2').style.display='none';
    document.getElementById(file_name+'_header_disply_3').style.display='none';
    document.getElementById(file_name+'_header_disply_4').style.display='none';
    document.getElementById(file_name+'_header_disply_5').style.display='none';

  }
  else if (value == '2'){
    // alert(value)
    document.getElementById(file_name+'_header_disply_1').style.display='none';
    document.getElementById(file_name+'_header_disply_2').style.display='block';
    document.getElementById(file_name+'_header_disply_3').style.display='none';
    document.getElementById(file_name+'_header_disply_4').style.display='none';
    document.getElementById(file_name+'_header_disply_5').style.display='none';
}
else if(value == '3'){
    // alert(value)

    document.getElementById(file_name+'_header_disply_1').style.display='none';
    document.getElementById(file_name+'_header_disply_2').style.display='none';
    document.getElementById(file_name+'_header_disply_3').style.display='block';
    document.getElementById(file_name+'_header_disply_4').style.display='none';
    document.getElementById(file_name+'_header_disply_5').style.display='none';


    }

  else if(value == '4'){
    // alert(value)

    document.getElementById(file_name+'_header_disply_1').style.display='none';
    document.getElementById(file_name+'_header_disply_2').style.display='none';
    document.getElementById(file_name+'_header_disply_3').style.display='none';
    document.getElementById(file_name+'_header_disply_4').style.display='block';
    document.getElementById(file_name+'_header_disply_5').style.display='none';
  }
  else if(value == '5'){
    // alert(value)

    document.getElementById(file_name+'_header_disply_1').style.display='none';
    document.getElementById(file_name+'_header_disply_2').style.display='none';
    document.getElementById(file_name+'_header_disply_3').style.display='none';
    document.getElementById(file_name+'_header_disply_4').style.display='none';
    document.getElementById(file_name+'_header_disply_5').style.display='block';
  }
}





// end of function for header row loading

</script>
<script type="text/javascript">//script to upload files from second step of multistep form //





</script>
<script type="text/javascript">
  //script for file headers upload
  function fileUpload() {
    // document.getElementById('loader').style.display = "block";
    document.querySelector('.loading-overlay').style.display = "block"
    var frm = new FormData($('#project_form').get(0));
    var d = $('#file_headers_id');
    var metadata = $('#metadata_id');
    $("#metadata_id").empty();

    // movetoNext();

    $.ajax({
      url: "/file/upload/",
      method: "POST",
      headers: { 'X-CSRFToken': '{{ csrf_token }}' },
      data: frm,
      cache: false,
      processData: false,
      contentType: false,
      crossdomain: true,
      dataType:"json",
      success: function (data)
      {
        console.log(data);
        // document.getElementById('loader').style.display = "none";
        document.querySelector('.loading-overlay').style.display = "none"
        if (data.error_msg) {
          // document.getElementById('loader').style.display = "none";
          document.querySelector('.loading-overlay').style.display = "none"

          alert(data.error_msg);
          $('#time_series_select_error').html(data.error_msg);
          $('#time_series_select_error').show()
        }
        else if (data.all_columns) {
          movetoNext();
          for (let [key, value] of Object.entries(data.all_columns)) {
            for (let [k, v] of Object.entries(data.column_nan)) {
              if (key == k){
                var count = v

              }


            }


            if (value == 0) {
              var html = `<div class="right_margin"><span>${key}</span><br />NAN Count ${count}<br><select id="${key}_select" name="${key}_select" onchange="selectFunction('${key}')" ><option value="zero" selected>Zero</option><option value="previous" >Previous Value</option><option value="drop" >Delete Row</option><option value="delete_column" >Delete Column</option><option value="custom_value" >Create New Value</option></select> <input type="number" id="${key}_input" name="${key}_input" style="display:none" desabled></div>`

              $("#metadata_id").append(html)
            }
            else if (value == "None") {
              var html =`<div class="right_margin"><span> ${key} </span><br />NAN Count ${count}<br><select id="${key}_select" name="${key}_select" onchange="selectFunction('${key}')"><option value="None" selected>None</option><option value="previous" >Previous Value</option><option value="drop" >Delete Row</option><option value="delete_column" >Delete Column</option><option value="custom_value" >Create New Value</option></select><input type="text" id="${key}_input" name="${key}_input" style="display:none" desabled></div>`
              $("#metadata_id").append(html)
            }
          }
        }
        else {
          movetoNext();
        }
      }
    });
  }

</script>
<script type="text/javascript">
  function fileHeaderYes(file_name) {
    var checked = document.getElementById(file_name + '_header_yes');
    // alert("value"+checked);
    if (checked.checked == true) {
      // alert('true');
      document.getElementById(file_name + '_header_disply').style.display = "block";
      document.getElementById(file_name + '_header').style.display = "none";
      document.getElementById(file_name + '_header_row_div').style.display = "block";
    }
    else {
      // alert('false');
      document.getElementById(file_name + '_header').style.display = "block";
      document.getElementById(file_name + '_header_row_div').style.display = "none";
      document.getElementById(file_name + '_header_disply').style.display = "none";
    }


  }
  function fileHeaderNo(file_name) {
    // alert("called" + file_name);

    var checked = document.getElementById(file_name + '_header_no');
    // alert("value" + checked);
    if (checked.checked == true) {
      // alert('true');
      document.getElementById(file_name + '_header').style.display = "block";
      document.getElementById(file_name + '_header_disply').style.display = "none";
      document.getElementById(file_name + '_header_row_div').style.display = "none";
    }
    else {
      // alert('false');
      document.getElementById(file_name + '_header_disply').style.display = "none";
      document.getElementById(file_name + '_header').style.display = "none";
      document.getElementById(file_name + '_header_row_div').style.display = "block";
    }


  }
  function file2No() {
    var checked = document.getElementById('file_2_no')
    if (checked == true) {
      document.getElementById('file_2_header').style.display = "none";
    }
    else {
      document.getElementById('file_2_header').style.display = "block";
    }


  }
  function file2Yes() {
    var checked = document.getElementById('file_2_yes')
    if (checked == true) {
      document.getElementById('file_2_header').style.display = "block";
    }
    else {
      document.getElementById('file_2_header').style.display = "none";
    }


  }
  function file3No() {
    var checked = document.getElementById('file_3_no')
    if (checked == true) {
      document.getElementById('file_3_header').style.display = "none";
    }
    else {
      document.getElementById('file_3_header').style.display = "block";
    }


  }
  function file3Yes() {
    var checked = document.getElementById('file_3_yes')
    if (checked == true) {
      document.getElementById('file_3_header').style.display = "block";
    }
    else {
      document.getElementById('file_3_header').style.display = "none";
    }


  }
</script>

<!-- script for relationship and metadata hadling -->
<script type="text/javascript">
  /// start script for metadata handling
  function metaDataGet() {
    // alert("called");
    // document.getElementById('loader').style.display = "block";
    document.querySelector('.loading-overlay').style.display = "block"

    var frm = new FormData($('#project_form').get(0));
    var pk = $('#id_project').val();
    // alert("called");

    var time_series_select = $('#time_series_select');
    $('#time_series_select').empty();
    var primarykey_relation_select = $('#primarykey_relation_id');
    var foreignkey_relation_select = $('#foreignkey_relation_id');

    $('#primarykey_relation_id').empty();
    $('#foreignkey_relation_id').empty();

    $.ajax({
      url: "/file/metadata/" + pk + "/",
      method: "POST",
      headers: { 'X-CSRFToken': '{{ csrf_token }}' },
      data: frm,
      cache: false,
      processData: false,
      contentType: false,
      crossdomain: true,
      dataType:"json",
      success: function (data)




      {
        // document.getElementById('loader').style.display = "none";
        document.querySelector('.loading-overlay').style.display = "none"
        console.log(data.relation_all_columns)

        if (data.error_msg) {
          alert(data.error_msg)
        }
        else if (data.relation_all_columns) {
          movetoNext();
          $('#relation_create_row_id').show();
          time_series_select.append('<option value="no-time-series">--------</option>');
          for (let [key, value] of Object.entries(data.time_series_all_columns)) {
            time_series_select.append('<option value="' + value + '">' + key + '</option>');
          };
          for (let [key, value] of Object.entries(data.relation_all_columns)) {
            primarykey_relation_select.append('<option value="' + key + '">' + value + '</option>');
          };
          for (let [key, value] of Object.entries(data.relation_all_columns)) {
            foreignkey_relation_select.append('<option value="' + key + '">' + value + '</option>');
          };
        }
        else {
          $('#relation_create_row_id').hide();
          movetoNext();

          time_series_select.append('<option value="no-time-series">--------</option>');
          for (let [key, value] of Object.entries(data.time_series_all_columns)) {
            time_series_select.append('<option value="' + value + '">' + value + '</option>');
          };
        }
      }
    });
  }
  /// end script for metadata handling



// fuction for the imputation
function selectFunction(name){
  // alert(name);
  id  = '#'+name+'_select'
  input_id = '#'+name+'_input'
  var value = $(id).val()
  if (value == 'custom_value'){
    $(input_id).prop( "disabled", false );
    // $(id).prop( "disabled", true );
    // $(id).hide();
    $(input_id).show();
  }
  else{
    $(input_id).prop( "disabled", true );
    // $(id).prop( "disabled", true );
    // $(id).hide();
    $(input_id).hide();

  }

}


  /// start script for metadata create
  function metaDataUpload() {
    // document.getElementById('loader').style.display = "block";
    document.querySelector('.loading-overlay').style.display = "block"

    var frm = new FormData($('#project_form').get(0));
    var pk = $('#id_project').val();



    $.ajax({
      url: "/project/",
      method: "POST",
      headers: { 'X-CSRFToken': '{{ csrf_token }}' },
      data: frm,
      cache: false,
      processData: false,
      contentType: false,
      crossdomain: true,
      dataType:"json",
      success: function (data) {
        // document.getElementById('loader').style.display = "none";
        document.querySelector('.loading-overlay').style.display = "none"
        if (data.msg) {
          // alert(data.msg);
          sucessFunction(data.pk)
        }
        else if (data.error_msg) {
          alert(data.error_msg)
        }
        console.log(data);

      }
    });
  }
  /// end script for metadata create
  function sucessFunction(pk) {
    var url = "https://brayn.ai/single-project/" + pk + "/";
    window.location = url;
  }

  function callLogout() {
    event.stopPropagation();
    // body...
    // document.getElementById("myDropdown").classList.remove("show");
    // document.getElementById("blog_dropdown").classList.remove("show");
    document.getElementById("logout").classList.toggle("show");
  }
</script>
<script type="text/javascript">
  /// start script for Relatioship handling
  function RelatioshipCreate() {
    var frm = new FormData($('#project_form').get(0));
    var pk = $('#id_project').val();

    document.getElementById('relation_error_msg_id').style.display = "none";

    var primarykey_relation_select = $('#primarykey_relation_id');
    var foreignkey_relation_select = $('#foreignkey_relation_id');



    $.ajax({
      url: "/file/relationship/" + pk + "/",
      method: "POST",
      headers: { 'X-CSRFToken': '{{ csrf_token }}' },
      data: frm,
      cache: false,
      processData: false,
      contentType: false,
      crossdomain: true,
      dataType:"json",
      success: function (data) {
        // alert(JSON.stringify(data.error_msg))
        if (data.relation_list) {
          // table.tBodies[0].rows.length;
          var html = `
                    <tr id="${data.relation_list.id}">
                      <td scope="row">${data.relation_list.file_1}</td>
                      <td>${data.relation_list.column_1}</td>
                      <td scope="row">${data.relation_list.file_2}</td>
                      <td>${data.relation_list.column_2}<i class="fa fa-trash" aria-hidden="true" style="margin-left:11%;"  onclick="RelatioshipDelete('${data.relation_list.id}')"></i></td>
                    </tr>
                    `;
          $('#relation_div_id').append(html);
          $('#table_display_section').show();
          $("#foreignkey_relation_id").val($("#foreignkey_relation_id option:eq()").val());
          $('#select2-foreignkey_relation_id-container').html("");
          $("#primarykey_relation_id").val($("#primarykey_relation_id option:eq()").val());
          $('#select2-primarykey_relation_id-container').html("");
        }
        else if (data.error_msg) {
          alert(data.error_msg);
        }

      }
    });
  }
  /// end script for Relatioship handling
</script>
<!-- end script for Relatioship and metadata handling -->
<script>

  function apiDataCheck() {
    // alert("called");
    document.querySelector('.loading-overlay').style.display = "block"
    var frm = new FormData($('#project_form').get(0));


    var pk = $('#id_project').val();
    var d = $('#file_headers_id');
    var content_div = $('#delimeter_content_id');
    $("#delimeter_content_id").empty();
    $("#file_headers_id").empty();

    $.ajax({
      url: "/api/data/" + pk + "/",
      method: "POST",
      headers: { 'X-CSRFToken': '{{ csrf_token }}' },
      data: frm,
      cache: false,
      processData: false,
      contentType: false,
      crossdomain: true,
      dataType:"json",
      success: function (data) {

        if (data.data) {
          document.querySelector('.loading-overlay').style.display = "none"
          movetoNext()

        modal.style.display = "none";
                 // document.getElementById('loader').style.display = "none";
                 document.querySelector('.loading-overlay').style.display = "none"
              var line_1 = escapeHTML(data.data.line_1);
              var line_2 = escapeHTML(data.data.line_2);
              var line_3 = escapeHTML(data.data.line_3);
              var line_4 = escapeHTML(data.data.line_4);
              var line_5 = escapeHTML(data.data.line_5);
              var header = escapeHTML(data.data.column_list);
              // alert(line_1+header);
              $('#total_project_files').html("TOTAL NO OF FILES: 1");
              var html = `<div class="raw_data_file_info" style="margin-bottom:3%;">
            <div class="row" style="border-bottom: 1px solid #d2c1c1;">
                        <div class="col-md-6">

                        </div>
                        <div class="col-md-6">
                          <label style="font-weight:bold;" title="Total number of uploaded files is indicated on the top right. Please scroll down to view a snapshot of all files uploaded.">File Number:</label>1
                        </div>
                        </div>
                        <div class="row" style="margin-right: 0%;">
                          <div class="col-md-12 table_content">
                            <table class="table table-striped tableFixHead">
                              <thead>
                                <tr><th style="width: 11%;">ROW NO </th><th>ROW DATA</th></tr>
                               </thead>
                                <tbody>

                                  <tr>
                                    <th scope="row" class="spaced">1</th>
                                    <td>${line_1}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">2</th>
                                    <td>${line_2}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">3</th>
                                    <td>${line_3}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">4</th>
                                    <td>${line_4}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">5</th>
                                    <td>${line_5}</td>
                                  </tr>
                                </tbody>
                            </table>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-12">
                           <div class="" id="">
                             <label style="font-weight:bold;">Header:</label><span >${header}</span>
                           </div>

                          </div>
                        </div>
                        </div>
                        `;
              content_div.append(html);
        }
        else if (data.error) {
          document.querySelector('.loading-overlay').style.display = "none";
          alert(data.error);
        }

      }
    });
  }


  /// end script for Relatioship handling


  // script for google sheet integration

  function googleDataCheck() {
    // alert("called");
    var frm = new FormData($('#project_form').get(0));

    var pk = $('#id_project').val();
    var d = $('#file_headers_id');
    var content_div = $('#delimeter_content_id');
    $("#delimeter_content_id").empty();
    $("#file_headers_id").empty();
    document.querySelector('.loading-overlay').style.display = "block"

    $.ajax({
      url: "/dataintegration/sheet-project-create/" + pk + "/",
      method: "POST",
      headers: { 'X-CSRFToken': '{{ csrf_token }}' },
      data: frm,
      cache: false,
      processData: false,
      contentType: false,
      crossdomain: true,
      dataType:"json",
      success: function (data) {

        if (data.data) {
              document.querySelector('.loading-overlay').style.display = "none"
              document.getElementById('myGoogleModal').style.display = "none";
              movetoNext()
                 // document.getElementById('loader').style.display = "none";

              var line_1 = escapeHTML(data.data.line_1);
              var line_2 = escapeHTML(data.data.line_2);
              var line_3 = escapeHTML(data.data.line_3);
              var line_4 = escapeHTML(data.data.line_4);
              var line_5 = escapeHTML(data.data.line_5);
              var header = escapeHTML(data.data.column_list);
              // alert(line_1+header);
              $('#total_project_files').html("TOTAL NO OF FILES: 1");
              var html = `<div class="raw_data_file_info" style="margin-bottom:3%;">
            <div class="row" style="border-bottom: 1px solid #d2c1c1;">
                        <div class="col-md-6">

                        </div>
                        <div class="col-md-6">
                          <label style="font-weight:bold;" title="Total number of uploaded files is indicated on the top right. Please scroll down to view a snapshot of all files uploaded.">File Number:</label>1
                        </div>
                        </div>
                        <div class="row" style="margin-right: 0%;">
                          <div class="col-md-12 table_content">
                            <table class="table table-striped tableFixHead">
                              <thead>
                                <tr><th style="width: 11%;">ROW NO </th><th>ROW DATA</th></tr>
                               </thead>
                                <tbody>

                                  <tr>
                                    <th scope="row" class="spaced">1</th>
                                    <td>${line_1}</td>
                                   </tr>
                                  <tr>
                                    <th scope="row">2</th>
                                    <td>${line_2}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">3</th>
                                    <td>${line_3}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">4</th>
                                    <td>${line_4}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">5</th>
                                    <td>${line_5}</td>
                                  </tr>
                                </tbody>
                            </table>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-12">
                           <div class="" id="">
                             <label style="font-weight:bold;">Header:</label><span >${header}</span>
                           </div>

                          </div>
                        </div>
                        </div>
                        `;
              content_div.append(html);
        }
        else if (data.error) {
          document.querySelector('.loading-overlay').style.display = "none"
          alert(data.error);
        }

      }
    });
  }
</script>

<!-- end of script for api data check-->


<script>
  document.getElementById('color_id').style.background = "#4a90e2";
  // document.getElementById('color_id').value = "rgb(74, 144, 226)";

  var files = {};
  var fileCollection
  //  start script to delete the relation
  function RelatioshipDelete(pk) {
    var frm = new FormData($('#project_form').get(0));
    var table = document.getElementById("relationship_table");
    document.getElementById('relation_error_msg_id').style.display = "none";
    // alert("called" + pk);
    var primarykey_relation_select = $('#primarykey_relation_id');
    var foreignkey_relation_select = $('#foreignkey_relation_id');
    $("#" + pk).remove();
    if (table.tBodies[0].rows.length < 1) {
      $('#table_display_section').hide();
    }



    $.ajax({
      url: "/file/relationship/delete/" + pk + "/",
      method: "POST",
      headers: { 'X-CSRFToken': '{{ csrf_token }}' },
      data: frm,
      cache: false,
      processData: false,
      contentType: false,
      crossdomain: true,
      dataType:"json",
      success: function (data) {
        // alert(JSON.stringify(data.error_msg))
        if (data.error_msg) {
          alert(data.error_msg);


        }
        else {
          id = '#' + data.id;
          $(id).remove();


        }
        $("#foreignkey_relation_id").val($("#foreignkey_relation_id option:eq()").val());
        $('#select2-foreignkey_relation_id-container').html("");
        $("#primarykey_relation_id").val($("#primarykey_relation_id option:eq()").val());
        $('#select2-primarykey_relation_id-container').html("");
        if (table.tBodies[0].rows.length < 2) {
          $('#table_display_section').hide();
        }

      }
    });
  }
  //  end  script to delete the relation

  //START: script for filnames display
  $(document).ready(function () {
    // document.querySelector('.file_names').style.overflow = 'hidden';
    fileCollection = [];

    // var file_names = document.querSelector('.input_files');
    $('.file_upload_section input').change(function () {
      files = $(this)[0].files;
      delete files[0]
      // console.log(files[0].size);
      // Math.round((fsize / 1024))
      // var FileSize = ;
      // alert(FileSize)
      for (i = 0; i < files.length; i++)
      {
         // alert(Math.round((files[i].size / 1024)))
         if (Math.round((files[i].size / 1024)) > 3145728000){
           alert('File size exceeds 30 MB');
           return
         }
      }

      $(".file_names").children().remove();
      // $('#id_files').val(files)
      // fileCollection.push(files);
      // // console.log(fileCollection);
      // fileCollection.forEach((item, i) => {
      //   // console.log(item);
      //   files[i] = item;
      // });

      console.log(files);
      $('#no_of_files').show();
      $('#no_of_files').text(this.files.length + " file(s) selected");
      if (this.files.length === 0) {
        // document.querySelector('.file_names').style.overflow = 'hidden';
        $(".file_names").children().remove();
      }

      // $('.file_upload_section p').text(file_names.value + " file(s) selected");
      for (var i = 0; i < files.length; i++) {
        // var html = `<li >${files[i].name}<i class="fa fa-times-circle file_delete_icon" aria-hidden="true" id=${files[i].name} onclick="deleteFile(this,${i})"></i></li>`;
        var html = `<li >${files[i].name}</li>`;
        // document.querySelector('.file_names').style.overflowY = 'scroll';
        $(".file_names").append(html);
      }
    });
  });
  //END: script for filnames display

  //START: script for Deleting Files
  function deleteFile(ele, index) {
    console.log(files[index]);
    delete files;
    console.log(files);

    ele.parentNode.parentNode.removeChild(ele.parentNode);
  }
  //END: script for Deleting Files

  //START: Color selection script
  function selectedColor(ele) {
    $('.color_height').removeClass('border_black');
    document.getElementById('color_id').style.background = ele.style.background;
    $('#'+ele.id).addClass('border_black');
    document.getElementById('color_id').value = ele.style.background;
  }
  //END: Color selection script








  //Delete later

function readFiles() {
    // alert("called");
    // document.getElementById('loader').style.display = "block";

    document.querySelector('.loading-overlay').style.display = "block";
    var frm = new FormData($('#project_form').get(0));

    var d = $('#file_headers_id');
    var content_div = $('#delimeter_content_id');

    console.log(files);

    $.ajax({
      url: "/file/read/",
      method: "POST",
      headers: { 'X-CSRFToken': '{{ csrf_token }}' },
      data: frm,
      cache: false,
      processData: false,
      contentType: false,
      crossdomain: true,
      dataType:"json",
      success: function (data) {
        if (data.error_msg) {
          // document.getElementById('loader').style.display = "none";
          document.querySelector('.loading-overlay').style.display = "none"
          alert(data.error_msg);
        }
        else if (data.files_content) {

          $("#delimeter_content_id").empty();
          $("#file_headers_id").empty();

          movetoNext()
          for (let [key, value] of Object.entries(data.files_content)) {

            // document.getElementById('loader').style.display = "none";
            document.querySelector('.loading-overlay').style.display = "none"
            if (data.files_content[key].csv == true) {
              var line_1 = escapeHTML(data.files_content[key].data.line_1);
              var line_2 = escapeHTML(data.files_content[key].data.line_2)
              var line_3 = escapeHTML(data.files_content[key].data.line_3)
              var line_4 = escapeHTML(data.files_content[key].data.line_4)
              var line_5 = escapeHTML(data.files_content[key].data.line_5)
              $('#total_project_files').html("TOTAL NO OF FILES:" + data.file_count);
              var html = `<div class="raw_data_file_info" style="margin-bottom:3%;">
            <div class="row" style="border-bottom: 1px solid #d2c1c1;">
                        <div class="col-md-6">
                          <label style="font-weight:bold;">File Name:</label><span style="margin-left:1%;">${key}</span>
                        </div>
                        <div class="col-md-6">
                          <label style="font-weight:bold;" title="Total number of uploaded files is indicated on the top right. Please scroll down to view a snapshot of all files uploaded.">File Number:</label><span style="margin-left:1%;">${data.files_content[key].file_no}</span>
                        </div>
                        </div>
                        <div class="row" style="margin-right: 0%;">
                          <div class="col-md-12 table_content">
                            <table class="table table-striped tableFixHead">
                              <thead>
                                <tr><th style="width: 11%;">ROW NO </th>
                                  <th>ROW DATA</th></tr>
                               </thead>
                                <tbody>

                                  <tr>
                                    <th scope="row">1</th>
                                    <td>${line_1}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">2</th>
                                    <td>${line_2}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">3</th>
                                    <td>${line_3}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">4</th>
                                    <td>${line_4}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">5</th>
                                    <td>${line_5}</td>
                                  </tr>
                                </tbody>
                            </table>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-4">
                            <label for="" style="font-weight:bold;">Separator:</label>
                            <select class="" name="${key}_separator">
                              <option value=",">,</option>
                              <option value=":">:</option>
                              <option value=";" >;</option>
                              <option valu="|">|</option>
                              <option valu="tab">Tab Space</option>
                            </select>
                          </div>
                          <div class="col-md-4">
                            <label style="margin-left: 15%;font-weight:bold;">Header:</label>
                             <label for="one">YES</label>
                             <input type="radio" id="${key}_header_yes" name="${key}_header_status" onclick="fileHeaderYes('${key}')" value="yes" style="width:10%;display: inline-block;margin-left:2%" checked />

                             <label for="two">NO</label>
                             <input type="radio" id="${key}_header_no" name="${key}_header_status" value="no" onclick="fileHeaderNo('${key}')" style="width:10%;display: inline-block;margin-left:2%" />
                          </div>
                          <div class="col-md-4" id="${key}_header_row_div" ><label style="font-weight:bold;">HEADER STARTS FROM </label>  <input type="number" id="${key}_header_row_input" onchange="headerRowDisplay('${key}')" name="${key}_header_row" value="1" min="1" style="width:20%;display: inline-block;margin-left:2%" /></div>
                        </div>
                        <div class="row">
                          <div class="col-md-12">
                           <div class="" id="${key}_header_disply">
                             <label style="font-weight:bold;">Header:</label>
                             <span id="${key}_header_disply_1">${line_1}</span>
                             <span id="${key}_header_disply_2"style="display:none;" >${line_2}</span>
                             <span id="${key}_header_disply_3" style="display:none;" >${line_3}</span>
                             <span id="${key}_header_disply_4" style="display:none;">${line_4}</span>
                             <span id="${key}_header_disply_5" style="display:none;">${line_5}</span>
                           </div>
                           <div class="" id="${key}_header" style="display:none;">
                             <div class="" style="display:flex;">
                               <label for="header_input" style="font-weight:bold;">HEADER:</label>
                               <input  name="${key}_header" value="" id="header_input" placeholder="USE COMMAS TO SEPARATE">
                             </div>
                           </div>
                          </div>
                        </div>
                        </div>
                        `;
              content_div.append(html);


            }
            else if (data.files_content[key].csv == false) {
              movetoNext()
              document.querySelector('.loading-overlay').style.display = "none"
              var line_1 = escapeHTML(data.files_content[key].data.line_1);
              var line_2 = escapeHTML(data.files_content[key].data.line_2)
              var line_3 = escapeHTML(data.files_content[key].data.line_3)
              var line_4 = escapeHTML(data.files_content[key].data.line_4)
              var line_5 = escapeHTML(data.files_content[key].data.line_5)

              $('#total_project_files').html("TOTAL NO OF FILES:" + data.file_count);
              var html = `<div class="raw_data_file_info" style="margin-bottom:3%;">
            <div class="row" style="border-bottom: 1px solid #d2c1c1;">
                        <div class="col-md-6">
                          <label style="font-weight:bold;">File Name:</label><span style="margin-left:1%;">${key}</span>
                        </div>
                        <div class="col-md-6">
                          <label style="font-weight:bold;">File Number:</label><span style="margin-left:1%;">${data.files_content[key].file_no}</span>
                        </div>
                        </div>
                        <div class="row" style="margin-right: 0%;">
                          <div class="col-md-12 table_content">
                            <table class="table table-striped">
                                <tbody>
                            <tr><th>ROW NO </th><th>ROW DATA</th></tr>
                                  <tr>
                                    <th scope="row">1</th>
                                    <td>${line_1}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">2</th>
                                    <td>${line_2}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">3</th>
                                    <td>${line_3}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">4</th>
                                    <td>${line_4}</td>
                                  </tr>
                                  <tr>
                                    <th scope="row">5</th>
                                    <td>${line_5}</td>
                                  </tr>
                                </tbody>
                            </table>
                          </div>
                        </div>
                        <div class="row">

                          <div class="col-md-6">
                            <label style="margin-left: 15%;font-weight:bold;">Header:</label>
                             <label for="one">YES</label>
                             <input type="radio" id="${key}_header_yes" name="${key}_header_status" onclick="fileHeaderYes('${key}')" value="yes" style="width:10%;display: inline-block;" checked />

                             <label for="two">NO</label>
                             <input type="radio" id="${key}_header_no" name="${key}_header_status" value="no" onclick="fileHeaderNo('${key}')" style="width:10%;display: inline-block;" />
                          </div>
                          <div class="col-md-6" id="${key}_header_row_div">HEADER STARTS FROM   <input type="number"  id="${key}_header_row_input" onchange="headerRowDisplay('${key}')"  name="${key}_header_row" value="1"  min="1" style="width:20%;display: inline-block;" /></div>
                        </div>
                        <div class="row">
                          <div class="col-md-12">
                           <div class="" id="${key}_header_disply">
                             <label style="font-weight:bold;">Header:</label><span id="${key}_header_disply_1">${line_1}</span><span id="${key}_header_disply_2" style="display:none;" >${line_2}</span><span id="${key}_header_disply_3" style="display:none;">${line_3}</span><span id="${key}_header_disply_4" style="display:none;">${line_4}</span><span id="${key}_header_disply_5" style="display:none;">${line_5}</span>
                           </div>
                           <div class="" id="${key}_header" style="display:none;">
                             <div class="" style="display:flex;">
                               <label for="header_input" style="font-weight:bold;">Header:</label>
                               <input  name="${key}_header" value="" id="header_input">
                             </div>
                           </div>
                          </div>
                        </div>
                        </div>
                        `;
              content_div.append(html);




            }


          }
        }
        else if (data.success){
          movetoNext()
          // document.getElementById('loader').style.display = "none";
          document.querySelector('.loading-overlay').style.display = "none"

        }



      }
    });
  }





  function escapeHTML(str) {
    return new Option(str).innerHTML;
  }


function GoogleModal(){


  document.getElementById("myGoogleModal").style.display='block';


}
  // Get the modal
var modal = document.getElementById("myGoogleModal");

// Get the button that opens the modal

var btn = document.getElementById("myGoogleBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal
btn.onclick = function() {
  alert("called"+modal)
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

//end of script to upload files from second step of multistep form //
</script>
<script>
// Get the modal
var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal
btn.onclick = function() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}



</script>



<script src="{%static 'js/jscolor.js' %}"></script>
